download.file("https://raw.githubusercontent.com/markziemann/SLE712_files/master/bioinfo_asst3_part1_files/gene_expression.tsv", destfile = "gene_expression.tsv")

# Ques 1: Read in the file, making the gene accession numbers the row names. Show a table of values for the first six genes
gene <- read.table("gene_expression.tsv")
head(gene) # Show a table of values for the first six genes
str(gene)

# Ques 2: Make a new column which is the mean of the other columns. Show a table of values for the first six genes.

gene <- read.table("gene_expression.tsv" , header = TRUE, stringsAsFactors = FALSE, row.names = 1)
gene$Means <- rowMeans(gene)
head(gene)
str(gene)


# Ques 3: List the 10 genes with the highest mean expression
order(gene$Mean)
gene[order(gene$Mean), ]
gene[order(-gene$Mean), ]
head(gene[order(-gene$Mean), ])
head(gene[order(-gene$Mean), ], 10)


# ques 4: Determine the number of genes with a mean <10
subset(gene,mean<10)
filtered <-subset(gene,mean<10)
nrow(filtered)


